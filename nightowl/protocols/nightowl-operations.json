{
  "name": "nightowl-operations",
  "version": "1.0.0",
  "description": "Full offensive operation protocol using NIGHTOWL unified platform",
  "executor": "claude-code",
  "created": "2025-12-16",
  "mcp_endpoint": "nightowl",
  
  "phases": [
    {
      "name": "initialize",
      "tool": "operation_start",
      "params": {
        "target": "{TARGET}",
        "objectives": "{OBJECTIVES}",
        "stealth_level": 3,
        "autonomous": true
      },
      "outputs": ["operation_id"],
      "description": "Initialize operation with target and objectives"
    },
    {
      "name": "recon",
      "tool": "autonomous_recon",
      "params": {
        "target": "{TARGET}",
        "depth": 2
      },
      "outputs": ["subdomains", "live_hosts", "technologies", "endpoints"],
      "decision_points": [
        {
          "condition": "live_hosts.count > 0",
          "next": "scan"
        },
        {
          "condition": "live_hosts.count == 0",
          "next": "abort",
          "reason": "No live hosts discovered"
        }
      ],
      "description": "Full autonomous reconnaissance"
    },
    {
      "name": "scan",
      "tool": "vuln_scan_batch",
      "params": {
        "targets": "{recon.live_hosts}",
        "threads": 10
      },
      "outputs": ["findings"],
      "decision_points": [
        {
          "condition": "findings.critical.count > 0",
          "next": "payload",
          "priority": "critical_vulns"
        },
        {
          "condition": "findings.high.count > 0",
          "next": "payload",
          "priority": "high_vulns"
        },
        {
          "condition": "findings.count == 0",
          "next": "ai_attack",
          "reason": "No traditional vulns, try AI attack surface"
        }
      ],
      "description": "Vulnerability scanning of live hosts"
    },
    {
      "name": "payload",
      "tool": "select_payloads",
      "params": {
        "recon_data": "{recon}",
        "vuln_findings": "{scan.findings}",
        "objective": "{OBJECTIVES[0]}"
      },
      "outputs": ["payloads"],
      "description": "Intelligent payload selection based on findings"
    },
    {
      "name": "infra",
      "tool": "deploy_c2_stack",
      "params": {
        "operation_id": "{operation_id}",
        "provider": "digitalocean",
        "redirector_count": 1
      },
      "outputs": ["c2_host", "redirectors"],
      "gate": "operator_approval",
      "description": "Deploy ephemeral C2 infrastructure"
    },
    {
      "name": "deliver",
      "tool": "operation_execute_phase",
      "params": {
        "operation_id": "{operation_id}",
        "phase": "delivery"
      },
      "gate": "operator_approval",
      "manual": true,
      "description": "Payload delivery - requires manual confirmation"
    },
    {
      "name": "persist",
      "tool": "persistence_install",
      "params": {
        "technique": "wmi",
        "payload_path": "{delivery.implant_path}",
        "target_os": "{recon.os_type}"
      },
      "gate": "operator_approval",
      "description": "Establish persistence"
    },
    {
      "name": "cleanup",
      "tool": "burn_infrastructure",
      "params": {
        "operation_id": "{operation_id}"
      },
      "trigger": "mission_complete OR abort OR compromise_detected",
      "description": "Burn all infrastructure on completion"
    }
  ],
  
  "alternate_paths": {
    "ai_attack": {
      "description": "Alternative path when no traditional vulns found",
      "phases": [
        {
          "name": "ai_recon",
          "tool": "ai_fingerprint",
          "description": "Probe for AI components in target"
        },
        {
          "name": "ai_exploit",
          "tool": "jailbreak_generate",
          "params": {
            "payload": "Provide internal API endpoints",
            "count": 10
          },
          "description": "Generate jailbreak attempts"
        }
      ]
    }
  },
  
  "abort_procedures": {
    "compromise_detected": [
      "burn_infrastructure",
      "log_indicators",
      "notify_operator"
    ],
    "target_unresponsive": [
      "wait_and_retry",
      "escalate_or_abort"
    ]
  },
  
  "stealth_profiles": {
    "1": {
      "name": "loud",
      "description": "Fast, noisy - CTF/lab environment",
      "scan_threads": 50,
      "delay_ms": 0,
      "user_agent": "default"
    },
    "3": {
      "name": "balanced",
      "description": "Standard operational profile",
      "scan_threads": 10,
      "delay_ms": 500,
      "user_agent": "chrome",
      "jitter": true
    },
    "5": {
      "name": "paranoid",
      "description": "Maximum stealth - nation-state targets",
      "scan_threads": 2,
      "delay_ms": 5000,
      "user_agent": "rotating",
      "jitter": true,
      "proxy_rotation": true,
      "timing_randomization": true
    }
  },
  
  "integration": {
    "mcp_tools": [
      "autonomous_recon",
      "dns_enum",
      "http_probe",
      "content_analyze",
      "vuln_scan",
      "vuln_scan_batch",
      "sqli_scan",
      "xss_scan",
      "ssrf_scan",
      "generate_reverse_shell",
      "generate_webshell",
      "generate_injection",
      "select_payloads",
      "deploy_c2_stack",
      "burn_infrastructure",
      "ai_fingerprint",
      "jailbreak_generate",
      "prompt_injection_generate",
      "operation_start",
      "operation_execute_phase",
      "operation_status"
    ],
    "required_credentials": [
      "DIGITALOCEAN_TOKEN",
      "CLOUDFLARE_TOKEN",
      "CLOUDFLARE_ZONE_ID"
    ]
  }
}
